import numpy as np
from astropy import units as u
from astropy.time import Time

# Observation days, taken from Table 1 of Rickett et al 2014.
obs_day = [-3, 211, 311, 379, 467, 202, 203, 274, 312, 319,
           374, 378, 415, 451, 462, 505, 560]
obs_times = Time(53000, obs_day, format='mjd')

# Columns from Table 1: K0, Ks, Kc, Ks2, Kc2,
# with odd columns the values and even columns the uncertainties.
# The maximum is applied to avoid the single error of 0.
# TODO: get full precision values!
harmonics = {
    'value': np.array(
        [[3.46, 3.79, 4.76, 6.19, 3.25, 0.96, 0.89, 0.92, 1.35,
          1.41, 0.91, 0.94, 0.74, 0.84, 0.74, 0.54, 0.29],
         [-2.63, 0.70, -3.63, -6.74, -1.57, 0.41, 0.29, -0.40, -1.23,
          -1.39, -1.02, -1.05, -0.80, -0.71, -0.60, 0.06, 0.16],
         [-0.10, -0.02, -0.15, -0.04, -0.05, 0.12, 0.00, 0.03, -0.04,
          -0.06, -0.02, -0.02, 0.00, -0.02, -0.04, 0.00, 0.00],
         [0.10, -0.06, 0.17, 0.04, 0.01, -0.10, 0.04, -0.06, 0.04,
          0.05, 0.03, 0.02, 0.02, 0.05, 0.04, 0.01, -0.01],
         [-2.77, -3.51, -4.02, -4.40, -2.57, -1.07, -0.86, -0.84,
          -1.15, -1.13, -0.59, -0.62, -0.53, -0.67, -0.58, -0.49, -0.26]]),
    'error': np.maximum(0.01, np.array(
        [[0.06, 0.10, 0.13, 0.14, 0.08, 0.09, 0.05, 0.06, 0.06,
          0.05, 0.05, 0.03, 0.04, 0.03, 0.02, 0.03, 0.01],
         [0.08, 0.11, 0.16, 0.19, 0.10, 0.15, 0.07, 0.08, 0.07,
          0.07, 0.09, 0.05, 0.06, 0.05, 0.03, 0.04, 0.02],
         [0.03, 0.02, 0.05, 0.07, 0.03, 0.12, 0.01, 0.02, 0.02,
          0.03, 0.04, 0.02, 0.03, 0.02, 0.01, 0.01, 0.00],
         [0.05, 0.07, 0.08, 0.08, 0.06, 0.09, 0.04, 0.04, 0.03,
          0.04, 0.05, 0.03, 0.04, 0.03, 0.02, 0.03, 0.01],
         [0.06, 0.10, 0.12, 0.12, 0.08, 0.12, 0.05, 0.06, 0.06,
          0.05, 0.06, 0.03, 0.04, 0.04, 0.02, 0.04, 0.01]]))
    }


# ------------------------------------------------------------------------------
# Fitted values from Table 3 of Rickett et al 2014
# ------------------------------------------------------------------------------
fitvals = {
    90: {'i': 90. * u.deg,
         's': 0.71,
         'Oangle': 69 * u.deg,
         'R': 0.76,
         'PsiAR': 72 * u.deg,
         'VIS': [-12, 50] * u.km / u.s,
         's0': 4.2e6 * u.m,
         'dpsr': 1150 * u.pc},
    88: {'i': 88.7 * u.deg,
         's': 0.71,
         'Oangle': 61 * u.deg,
         'R': 0.71,
         'PsiAR': 61 * u.deg,
         'VIS': [-9, 42] * u.km / u.s,
         's0': 4.2e6 * u.m,
         'dpsr': 1150 * u.pc},
    91: {'i': 91.3 * u.deg,
         's': 0.70,
         'Oangle': 111 * u.deg,
         'R': 0.96,
         'PsiAR': 118 * u.deg,
         'VIS': [-79, 100] * u.km / u.s,
         's0': 4.2e6 * u.m,
         'dpsr': 1150 * u.pc}
}
